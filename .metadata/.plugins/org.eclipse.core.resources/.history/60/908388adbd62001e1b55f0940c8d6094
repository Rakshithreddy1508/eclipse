package Assignment;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import PreparedStatement.ConnectDB;

public class BusinessLogic {
	void createData() throws SQLException {
		Connection connection = ConnectDB.setupConnection();
		String query ="INSERT INTO employee ( id, name,des,cost ) VALUES( ?,?, ?,?)";
//		String query = "insert values into employee(? ,? ,?)  ";
		PreparedStatement myStmt = connection.prepareStatement(query);
		myStmt.setInt(1, 666);
		myStmt.setString(2, "Nagasree");
		myStmt.setString(4, "Management");
		myStmt.setInt(3, 6666);

		int success = myStmt.executeUpdate();
		System.out.println("Added Successfully " + success);
     	}
	void readData() throws SQLException {


		Connection connection=ConnectDB.setupConnection();

		 Statement statement;
		 statement = connection.createStatement();
         ResultSet resultSet;
         resultSet = statement.executeQuery(
             "select * from Products where id>=1111");
         int id; //id, name,Price, des
         String name;
         String des;
         int cost;

         while (resultSet.next()) {
             id = resultSet.getInt("id");
             name = resultSet.getString("name");
             des=resultSet.getString("des");
             cost=resultSet.getInt("cost");
             System.out.println("id : " + id
                                + " name : " + name  +" des:"+ des+"cost: " + cost);
         }
   }
}
